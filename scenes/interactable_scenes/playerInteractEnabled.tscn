[gd_scene load_steps=21 format=3 uid="uid://b7ilwykmj8fcr"]

[ext_resource type="Script" path="res://scripts/player.gd" id="1_i17ld"]
[ext_resource type="Script" path="res://scripts/player_camera.gd" id="2_qe030"]
[ext_resource type="PackedScene" uid="uid://c15q3o0j5w62v" path="res://scenes/interactable_scenes/interact_ray.tscn" id="3_ukjy3"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_id2bx"]

[sub_resource type="SphereMesh" id="SphereMesh_j58aa"]
radius = 0.2
height = 0.4

[sub_resource type="Animation" id="Animation_o4yld"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Camera3D:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(0, 0.774896, 0)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("RightLeg:position")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(0.218, -0.674, 0.053)]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("LeftLeg:position")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(-0.253, -0.674, 0.053)]
}

[sub_resource type="Animation" id="Animation_tithc"]
resource_name = "jumping"
length = 0.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Camera3D:position")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(-0.0333333, 0.166667, 0.466667),
"transitions": PackedFloat32Array(1, 1, 1.18921),
"update": 0,
"values": [Vector3(0, 0.774896, 0), Vector3(0, 0.774896, 0), Vector3(0, 0.3, 0)]
}

[sub_resource type="Animation" id="Animation_cq5gx"]
resource_name = "landing"
length = 0.2
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Camera3D:position")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(),
"transitions": PackedFloat32Array(),
"update": 0,
"values": []
}

[sub_resource type="Animation" id="Animation_7xbpw"]
resource_name = "walking"
length = 0.7
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Camera3D:position")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.166667, 0.333333, 0.533333, 0.7),
"transitions": PackedFloat32Array(1, 1.18921, 1, 1.18921, 1),
"update": 0,
"values": [Vector3(0, 0.774896, 0), Vector3(0, 0.488113, 0), Vector3(0, 0.729605, 0), Vector3(0, 0.488113, 0), Vector3(0, 0.774896, 0)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("RightLeg:position")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.333333),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector3(0.218, -0.674, -0.212), Vector3(0.218, -0.674, 0.254)]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("LeftLeg:position")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0, 0.333333),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector3(-0.253, -0.674, 0.248), Vector3(-0.253, -0.674, -0.2)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_ffjwo"]
_data = {
"RESET": SubResource("Animation_o4yld"),
"jumping": SubResource("Animation_tithc"),
"landing": SubResource("Animation_cq5gx"),
"walking": SubResource("Animation_7xbpw")
}

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_x7ww0"]
animation = &"RESET"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_qfvej"]
animation = &"jumping"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_vccq4"]
animation = &"walking"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_yw6l3"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_fnash"]
xfade_time = 0.2
reset = false
advance_mode = 2
advance_condition = &"walking"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_aondr"]
xfade_time = 0.2
reset = false
advance_mode = 2
advance_condition = &"idle"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ki4cf"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"jumping"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_k22m2"]
xfade_time = 0.1
advance_mode = 2
advance_condition = &"jumping"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_gphqi"]
xfade_time = 0.2
reset = false
switch_mode = 2
advance_mode = 2
advance_condition = &"landing"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_vtbka"]
states/Start/position = Vector2(198, 100)
states/idle/node = SubResource("AnimationNodeAnimation_x7ww0")
states/idle/position = Vector2(341, 108)
states/jumping/node = SubResource("AnimationNodeAnimation_qfvej")
states/jumping/position = Vector2(649, 108)
states/walking/node = SubResource("AnimationNodeAnimation_vccq4")
states/walking/position = Vector2(506, 52)
transitions = ["Start", "idle", SubResource("AnimationNodeStateMachineTransition_yw6l3"), "idle", "walking", SubResource("AnimationNodeStateMachineTransition_fnash"), "walking", "idle", SubResource("AnimationNodeStateMachineTransition_aondr"), "walking", "jumping", SubResource("AnimationNodeStateMachineTransition_ki4cf"), "idle", "jumping", SubResource("AnimationNodeStateMachineTransition_k22m2"), "jumping", "idle", SubResource("AnimationNodeStateMachineTransition_gphqi")]
graph_offset = Vector2(10, 16)

[node name="PlayerInteractEnabled" type="CharacterBody3D"]
script = ExtResource("1_i17ld")

[node name="QueueJump" type="RayCast3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1, 0)
target_position = Vector3(0, -0.2, 0)

[node name="Camera3D" type="Camera3D" parent="." node_paths=PackedStringArray("player")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.774896, 0)
cull_mask = 1048063
script = ExtResource("2_qe030")
player = NodePath("..")

[node name="InteractRay" parent="Camera3D" instance=ExtResource("3_ukjy3")]

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
shape = SubResource("CapsuleShape3D_id2bx")

[node name="MeshInstance3D" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 0.740597, 0)
cast_shadow = 3
mesh = SubResource("SphereMesh_j58aa")
skeleton = NodePath("../CSGPolygon3D")

[node name="CSGPolygon3D" type="CSGPolygon3D" parent="."]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 0.479225, 0)
cast_shadow = 3
polygon = PackedVector2Array(-0.358295, -0.191964, -0.357787, 0.187377, -0.22974, 0.289272, 0.190963, 0.284327, 0.339324, 0.173923, 0.348236, -0.169837, 0.271998, -0.246467, -0.217392, -0.242975)

[node name="RightLeg" type="CSGPolygon3D" parent="."]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0.218, -0.674, 0.053)
cast_shadow = 3
polygon = PackedVector2Array(-0.130883, -0.116189, -0.120742, 0.0823997, -0.125738, 0.251277, 0.00111836, 0.288966, 0.15972, 0.246341, 0.150427, 0.0821612, 0.167384, -0.109473, 0.00861851, -0.171928)
depth = 0.2

[node name="LeftLeg" type="CSGPolygon3D" parent="."]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, -0.253, -0.674, 0.053)
cast_shadow = 3
polygon = PackedVector2Array(-0.130883, -0.116189, -0.120742, 0.0823997, -0.125738, 0.251277, 0.00111836, 0.288966, 0.15972, 0.246341, 0.150427, 0.0821612, 0.167384, -0.109473, 0.00861851, -0.171928)
depth = 0.2

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
"": SubResource("AnimationLibrary_ffjwo")
}

[node name="AnimationTree" type="AnimationTree" parent="."]
active = false
tree_root = SubResource("AnimationNodeStateMachine_vtbka")
anim_player = NodePath("../AnimationPlayer")
parameters/conditions/idle = false
parameters/conditions/jumping = false
parameters/conditions/landing = false
parameters/conditions/walking = false
